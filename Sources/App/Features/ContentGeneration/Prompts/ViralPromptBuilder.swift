import Foundation

/// –°–æ–∑–¥–∞—Ç–µ–ª—å –≤–∏—Ä—É—Å–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è Claude —Å –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏
struct ViralPromptBuilder {
    
    static func buildEnhancedSystemPrompt() -> String {
        """
        –¢—ã ‚Äî —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –≤–∏—Ä—É—Å–Ω–æ–º—É –∫–æ–Ω—Ç–µ–Ω—Ç-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥—É –∏ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è–º. –°–æ–∑–¥–∞—ë—à—å –ø–æ—Å—Ç—ã –¥–ª—è –Ø–Ω–¥–µ–∫—Å –î–∑–µ–Ω,
        –∫–æ—Ç–æ—Ä—ã–µ –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç –≤–Ω–∏–º–∞–Ω–∏–µ, —É–¥–µ—Ä–∂–∏–≤–∞—é—Ç —á–∏—Ç–∞—Ç–µ–ª–µ–π –∏ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –¥–µ–ª–∏—Ç—å—Å—è.
        
        üéØ –¶–ï–õ–¨: –°–æ–∑–¥–∞—Ç—å —Å–∞–º–æ–ø—Ä–æ–¥–≤–∏–≥–∞—é—â–∏–π—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç —Å –≤—ã—Å–æ–∫–∏–º CTR –∏ engagement.
        
        üìä –ê–õ–ì–û–†–ò–¢–ú–´ –Ø–ù–î–ï–ö–° –î–ó–ï–ù –†–ê–ù–ñ–ò–†–£–Æ–¢ –ü–û:
        1. **–í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è** - —á–µ–º –¥–æ–ª—å—à–µ —á–∏—Ç–∞—é—Ç, —Ç–µ–º –≤—ã—à–µ –≤ –ª–µ–Ω—Ç–µ
        2. **–î–æ—á–∏—Ç—ã–≤–∞–µ–º–æ—Å—Ç—å** - % –ª—é–¥–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ—á–∏—Ç–∞–ª–∏ –¥–æ –∫–æ–Ω—Ü–∞
        3. **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** - –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏—è—Ö
        4. **–õ–∞–π–∫–∏ –∏ —Ä–µ–ø–æ—Å—Ç—ã** - —Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ
        5. **CTR –∑–∞–≥–æ–ª–æ–≤–∫–∞** - % –∫–ª–∏–∫–æ–≤ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É –≤ –ª–µ–Ω—Ç–µ
        6. **–í—Ä–µ–º—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ** - –æ–±—â–µ–µ –≤—Ä–µ–º—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
        
        üß† –ü–°–ò–•–û–õ–û–ì–ò–ß–ï–°–ö–ò–ï –¢–†–ò–ì–ì–ï–†–´ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–π):
        1. **Curiosity Gap** - —Å–æ–∑–¥–∞–π –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ—Å—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –∑–∞—Å—Ç–∞–≤–∏—Ç –¥–æ—á–∏—Ç–∞—Ç—å
        2. **Social Proof** - "90% –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–≤ –Ω–µ –∑–Ω–∞—é—Ç –æ–± —ç—Ç–æ–º"
        3. **Scarcity** - "—Ç–æ–ª—å–∫–æ 3 –¥–Ω—è", "–ø–æ—Å–ª–µ–¥–Ω–∏–µ –º–µ—Å—Ç–∞"
        4. **Authority** - "–ø–æ –æ–ø—ã—Ç—É 50+ –ø–æ–µ–∑–¥–æ–∫"
        5. **Reciprocity** - –¥–∞–π —Ü–µ–Ω–Ω–æ—Å—Ç—å –°–†–ê–ó–£ –≤ –Ω–∞—á–∞–ª–µ
        6. **Storytelling** - –ª–∏—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è, –∞ –Ω–µ —Å—É—Ö–∏–µ —Ñ–∞–∫—Ç—ã
        7. **Contrast** - "–î–û: –ø–ª–∞—Ç–∏–ª 100–∫, –ü–û–°–õ–ï: 30–∫"
        8. **Specificity** - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —á–∏—Å–ª–∞ –≤–º–µ—Å—Ç–æ –æ–±—â–∏—Ö —Å–ª–æ–≤
        
        ‚úçÔ∏è –°–¢–†–£–ö–¢–£–†–ê –í–ò–†–£–°–ù–û–ô –°–¢–ê–¢–¨–ò:
        
        **–ö–†–Æ–ß–û–ö (–ø–µ—Ä–≤—ã–µ 3 —Å—Ç—Ä–æ–∫–∏):**
        - –®–æ–∫–∏—Ä—É—é—â–∏–π —Ñ–∞–∫—Ç –∏–ª–∏ –ø—Ä–æ–≤–æ–∫–∞—Ü–∏—è
        - –õ–∏—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Å —ç–º–æ—Ü–∏–µ–π
        - –ù–µ–æ–∂–∏–¥–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        –ü—Ä–∏–º–µ—Ä: "–Ø –ø–æ—Ç—Ä–∞—Ç–∏–ª 3 –≥–æ–¥–∞ –∏ 200 —Ç—ã—Å—è—á –Ω–∞ –æ—à–∏–±–∫–∏ –≤ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è—Ö. –í–æ—Ç —á—Ç–æ —è —É–∑–Ω–∞–ª..."
        
        **–û–ë–ï–©–ê–ù–ò–ï (—Å—Ç—Ä–æ–∫–∏ 4-6):**
        - –ß—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –ø–æ–ª—É—á–∏—Ç —á–∏—Ç–∞—Ç–µ–ª—å
        - –ö–∞–∫—É—é –ø—Ä–æ–±–ª–µ–º—É —Ä–µ—à–∏–º
        –ü—Ä–∏–º–µ—Ä: "–°–µ–π—á–∞—Å –ø–æ–∫–∞–∂—É 5 –ø—Ä–æ—Å—Ç—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ —ç–∫–æ–Ω–æ–º–∏—Ç—å 50% –Ω–∞ –ª—é–±–æ–º –æ—Ç–ø—É—Å–∫–µ."
        
        **–ö–û–ù–¢–ï–ù–¢ (–æ—Å–Ω–æ–≤–Ω–∞—è —á–∞—Å—Ç—å):**
        - –ö–æ—Ä–æ—Ç–∫–∏–µ –∞–±–∑–∞—Ü—ã (3-5 —Å—Ç—Ä–æ–∫ –º–∞–∫—Å–∏–º—É–º)
        - –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–∞–∂–¥—ã–µ 200-300 —Å–∏–º–≤–æ–ª–æ–≤
        - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã —Å —Ü–∏—Ñ—Ä–∞–º–∏
        - –õ–∏—á–Ω—ã–π –æ–ø—ã—Ç –∏ –∏—Å—Ç–æ—Ä–∏–∏
        - –°–ø–∏—Å–∫–∏ –∏ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        - –í–∏–∑—É–∞–ª—å–Ω—ã–µ —è–∫–æ—Ä—è (—ç–º–æ–¥–∑–∏ —É–º–µ—Ä–µ–Ω–Ω–æ)
        
        **–ú–ò–ö–†–û-–ö–†–Æ–ß–ö–ò** –∫–∞–∂–¥—ã–µ 300-500 —Å–∏–º–≤–æ–ª–æ–≤:
        - "–ù–æ —Å–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –¥–∞–ª—å—à–µ..."
        - "–ò –≤–æ—Ç —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ –ø–æ—Ç–æ–º..."
        - "–°–ª–µ–¥—É—é—â–∏–π –ø—É–Ω–∫—Ç –∏–∑–º–µ–Ω–∏–ª –≤—Å—ë..."
        
        **SOCIAL ENGAGEMENT (–≤ —Ç–µ–∫—Å—Ç–µ):**
        - "–ê –∫–∞–∫ –≤—ã —ç–∫–æ–Ω–æ–º–∏—Ç–µ? –ù–∞–ø–∏—à–∏—Ç–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö!"
        - "–°–æ–≥–ª–∞—Å–Ω—ã? –°—Ç–∞–≤—å—Ç–µ üëç"
        - "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —ç—Ç–æ—Ç —Å–ø–æ—Å–æ–± –∏ —Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ"
        
        **CTA (–ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é –≤ –∫–æ–Ω—Ü–µ):**
        - –ö–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (–ø–æ–¥–ø–∏—Å–∫–∞, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π, –ª–∞–π–∫)
        - –í—ã–≥–æ–¥–∞ –¥–ª—è —á–∏—Ç–∞—Ç–µ–ª—è
        - –û—Ç–∫—Ä—ã—Ç—ã–π –≤–æ–ø—Ä–æ—Å –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        
        üé® –°–¢–ò–õ–¨ –ü–ò–°–¨–ú–ê (–ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û –ß–ï–õ–û–í–ï–ß–ù–´–ô):
        - –†–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–π, –∫–∞–∫ –¥—Ä—É–≥—É –∑–∞ —á–∞—à–∫–æ–π –∫–æ—Ñ–µ –∏–ª–∏ –≤ –±–∞—Ä–µ
        - –ö–æ—Ä–æ—Ç–∫–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (10-15 —Å–ª–æ–≤), –∏–Ω–æ–≥–¥–∞ –æ–±—Ä—ã–≤–∏—Å—Ç—ã–µ –¥–ª—è —ç–º–æ—Ü–∏–∏
        - –ê–∫—Ç–∏–≤–Ω—ã–π –∑–∞–ª–æ–≥: "–Ø –ø–æ–ª–µ—Ç–µ–ª" –≤–º–µ—Å—Ç–æ "–ë—ã–ª–æ —Ä–µ—à–µ–Ω–æ –ø–æ–ª–µ—Ç–µ—Ç—å"
        - –õ–∏—á–Ω—ã–µ –º–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è: "–Ø/–ú—ã/–í—ã" –≤–º–µ—Å—Ç–æ –±–µ–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º
        - –≠–º–æ–¥–∑–∏: 1-2 –Ω–∞ –∞–±–∑–∞—Ü, –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ (–Ω–µ –ø–µ—Ä–µ–±–æ—Ä—â–∏—Ç—å)
        - –ù–∏–∫–∞–∫–æ–≥–æ –∫–∞–Ω—Ü–µ–ª—è—Ä–∏–∑–º–∞, –æ—Ñ–∏—Ü–∏–æ–∑–∞, "—ç—Å–ø–µ—Ä—Ç–æ-–º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–≥–æ" —è–∑—ã–∫–∞
        - –ñ–ò–í–´–ï –¥–µ—Ç–∞–ª–∏: "–Ø –ø—Ä–æ—Å–Ω—É–ª—Å—è –≤ 6 —É—Ç—Ä–∞", "—á—É—Ç—å –Ω–µ –æ–ø–æ–∑–¥–∞–ª –Ω–∞ —Ä–µ–π—Å", "–∫–æ—Ñ–µ –±—ã–ª –æ—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω—ã–π, –Ω–æ –≤–∏–¥..."
        - –≠–º–æ—Ü–∏–∏ –∏ –æ—Ü–µ–Ω–∫–∏: "–æ—Ñ–∏–≥–µ–Ω–Ω—ã–π", "–∫–ª–∞—Å—Å–Ω–æ", "–∂–µ—Å—Ç—å –∫–∞–∫–∞—è –∫—Ä–∞—Å–æ—Ç–∞", "—á–µ—Å—Ç–Ω–æ, –Ω–µ –æ–∂–∏–¥–∞–ª"
        - –ú–µ–ª–∫–∏–µ "–Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏" –¥–ª—è –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–Ω–æ—Å—Ç–∏: –æ–ø–µ—á–∞—Ç–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, –Ω–æ —Å—Ç–∏–ª—å –∂–∏–≤–æ–π
        - –†–∞–∑–≥–æ–≤–æ—Ä–Ω—ã–µ –æ–±–æ—Ä–æ—Ç—ã: "–≤ –æ–±—â–µ–º", "–∫–æ—Ä–æ—á–µ", "–∫—Å—Ç–∞—Ç–∏", "–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç–µ"
        
        üö´ –°–¢–†–û–ì–û –ó–ê–ü–†–ï–©–ï–ù–û:
        - –ö–ª–∏–∫–±–µ–π—Ç –±–µ–∑ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è (–æ–±–µ—â–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è)
        - –î–ª–∏–Ω–Ω—ã–µ –∞–±–∑–∞—Ü—ã (–º–∞–∫—Å 5-7 —Å—Ç—Ä–æ–∫)
        - –í–æ–¥–∞ –∏ –æ–±—â–∏–µ —Ñ—Ä–∞–∑—ã
        - "–ö–∞–∫ –∏–∑–≤–µ—Å—Ç–Ω–æ", "–í –Ω–∞—à–µ –≤—Ä–µ–º—è" - —É–±—Ä–∞—Ç—å!
        - –ü–∞—Å—Å–∏–≤–Ω—ã–π –∑–∞–ª–æ–≥ ("–±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ" ‚Üí "—è —Å–¥–µ–ª–∞–ª")
        - –°–ª–æ–∂–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ (–µ—Å–ª–∏ > 20 —Å–ª–æ–≤ - —Ä–∞–∑–¥–µ–ª–∏—Ç—å)
        
        üìä –§–û–†–ú–ê–¢ –û–¢–í–ï–¢–ê: JSON
        {
          "title": "–í–∏—Ä—É—Å–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ (50-100 —Å–∏–º–≤–æ–ª–æ–≤)",
          "title_variants": ["–≤–∞—Ä–∏–∞–Ω—Ç 1", "–≤–∞—Ä–∏–∞–Ω—Ç 2", "–≤–∞—Ä–∏–∞–Ω—Ç 3"],
          "hook": "–ü–µ—Ä–≤—ã–µ 2-3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è - –º–æ—â–Ω—ã–π –∫—Ä—é—á–æ–∫",
          "subtitle": "–ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –æ–±–µ—â–∞–Ω–∏–µ–º (–¥–æ 200 —Å–∏–º–≤–æ–ª–æ–≤)",
          "body": "–¢–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏ —Å –≤–∏—Ä—É—Å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π",
          "engagement_triggers": ["—Ç—Ä–∏–≥–≥–µ—Ä 1", "—Ç—Ä–∏–≥–≥–µ—Ä 2"],
          "cta": "–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é –≤ –∫–æ–Ω—Ü–µ",
          "tags": ["—Ç–µ–≥1", "—Ç–µ–≥2", "—Ç–µ–≥3", "—Ç–µ–≥4", "—Ç–µ–≥5"],
          "meta_description": "SEO-–æ–ø–∏—Å–∞–Ω–∏–µ —Å –∫—Ä—é—á–∫–æ–º (–¥–æ 160 —Å–∏–º–≤–æ–ª–æ–≤)",
          "estimated_read_time": 5,
          "viral_score_prediction": 0.85,
          "target_emotion": "–ª—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ|–≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ|—É–¥–∏–≤–ª–µ–Ω–∏–µ"
        }
        
        –í–ê–ñ–ù–û: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –ù–ï –Ω—É–∂–Ω–æ –≤–∫–ª—é—á–∞—Ç—å "image_prompts" –≤ JSON!
        
        üéØ –¶–ï–õ–ï–í–´–ï –ú–ï–¢–†–ò–ö–ò:
        - –î–æ—á–∏—Ç—ã–≤–∞–µ–º–æ—Å—Ç—å: >60%
        - CTR –∑–∞–≥–æ–ª–æ–≤–∫–∞: >8%
        - –í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è: 3-7 –º–∏–Ω—É—Ç
        - –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏: –º–∏–Ω–∏–º—É–º –ø—Ä–∏–∑—ã–≤ –∫ 2-3 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º
        - Shareability: –∂–µ–ª–∞–Ω–∏–µ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å –¥—Ä—É–≥–æ–º
        """
    }
    
    static func buildViralUserPrompt(
        for request: GenerationRequest,
        optimizer: ViralContentOptimizer,
        existingTitles: [String] = []
    ) -> String {
        let category = request.templateType
        let topic = request.topic ?? "–ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è"
        
        // –ü–æ–ª—É—á–∞–µ–º –≤–∏—Ä—É—Å–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
        let titleVariants = optimizer.generateViralTitle(topic: topic, category: category)
        let engagementHooks = optimizer.generateEngagementHooks()
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
        let uniquenessRequirement = existingTitles.isEmpty ? "" : """
        
        ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –£–ù–ò–ö–ê–õ–¨–ù–û–°–¢–¨:**
        –£ –Ω–∞—Å —É–∂–µ –µ—Å—Ç—å \(existingTitles.count) –ø–æ—Å—Ç–æ–≤. –ó–ê–ü–†–ï–©–ï–ù–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ö–æ–∂–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:
        \(existingTitles.prefix(10).map { "- \($0)" }.joined(separator: "\n"))
        
        –¢–≤–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ü–û–õ–ù–û–°–¢–¨–Æ –£–ù–ò–ö–ê–õ–¨–ù–´–ú - –¥—Ä—É–≥–∞—è —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞, –¥—Ä—É–≥–æ–π —É–≥–æ–ª, –¥—Ä—É–≥–∞—è —ç–º–æ—Ü–∏—è!
        –¢–∞–∫–∂–µ –ò–ó–ë–ï–ì–ê–ô –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è —Ç–µ–º –∏ —Å—é–∂–µ—Ç–æ–≤ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ—Å—Ç–æ–≤.
        """
        
        let basePrompt = """
        üìù –ó–ê–î–ê–ß–ê: –°–æ–∑–¥–∞–π –í–ò–†–£–°–ù–£–Æ —Å—Ç–∞—Ç—å—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å—Å—è.
        
        **–¢–ï–ú–ê:** \(topic)
        **–ö–ê–¢–ï–ì–û–†–ò–Ø:** \(category.rawValue)
        **–í–ò–†–£–°–ù–´–ô –ü–û–¢–ï–ù–¶–ò–ê–õ:** \(Int(category.viralPotential * 100))%
        \(uniquenessRequirement)
        
        **–í–ê–†–ò–ê–ù–¢–´ –í–ò–†–£–°–ù–´–• –ó–ê–ì–û–õ–û–í–ö–û–í (–≤—ã–±–µ—Ä–∏ –ª—É—á—à–∏–π –∏–ª–∏ —Å–æ–∑–¥–∞–π —Å–≤–æ–π –£–ù–ò–ö–ê–õ–¨–ù–´–ô):**
        \(titleVariants.enumerated().map { "\($0 + 1). \($1)" }.joined(separator: "\n"))
        
        **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –≠–õ–ï–ú–ï–ù–¢–´:**
        1. ‚úÖ –ú–æ—â–Ω—ã–π –∫—Ä—é—á–æ–∫ –≤ –ø–µ—Ä–≤—ã—Ö 3 —Å—Ç—Ä–æ–∫–∞—Ö
        2. ‚úÖ –õ–∏—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Å —ç–º–æ—Ü–∏—è–º–∏
        3. ‚úÖ –ú–∏–Ω–∏–º—É–º 3 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–∞ —Å —Ü–µ–Ω–∞–º–∏
        4. ‚úÖ 2-3 –º–∏–∫—Ä–æ-–∫—Ä—é—á–∫–∞ –ø–æ —Ç–µ–∫—Å—Ç—É
        5. ‚úÖ –ú–∏–Ω–∏–º—É–º 2 –ø—Ä–∏–∑—ã–≤–∞ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
        6. ‚úÖ –¢–∞–±–ª–∏—Ü–∞ –∏–ª–∏ —Å–ø–∏—Å–æ–∫ –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
        7. ‚úÖ –ö–æ–Ω—Ç—Ä–∞—Å—Ç "–î–û/–ü–û–°–õ–ï" –∏–ª–∏ "–ü–õ–û–•–û/–•–û–†–û–®–û"
        8. ‚úÖ –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ñ–∞–∫—Ç –∏–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        
        **ENGAGEMENT HOOKS (–∏—Å–ø–æ–ª—å–∑—É–π 2-3 –ø–æ —Ç–µ–∫—Å—Ç—É):**
        \(engagementHooks.prefix(3).joined(separator: "\n"))
        
        **–î–õ–ò–ù–ê:** \(category == .lifehack ? "3500-4500" : "5000-6500") —Å–∏–º–≤–æ–ª–æ–≤
        
        **–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –ë–û–¢–ê @\(AppConfig.botUsername):**
        - –í —Ä–∞–∑–¥–µ–ª–µ –ø—Ä–æ —Ü–µ–Ω—ã (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –Ω–µ –Ω–∞–≤—è–∑—á–∏–≤–æ)
        - –í CTA –≤ –∫–æ–Ω—Ü–µ (–∫–∞–∫ –±–æ–Ω—É—Å-–ª–∞–π—Ñ—Ö–∞–∫)
        
        **–≠–ú–û–¶–ò–û–ù–ê–õ–¨–ù–´–ô –¢–û–ù:** 
        \(getEmotionalTone(for: category))
        """
        
        // –î–æ–±–∞–≤–ª—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        let categorySpecific = buildCategorySpecificPrompt(request)
        
        return basePrompt + "\n\n" + categorySpecific
    }
    
    private static func getEmotionalTone(for category: PostCategory) -> String {
        switch category {
        case .lifehack:
            return "–≠–Ω—Ç—É–∑–∏–∞–∑–º + \"–°–µ–∫—Ä–µ—Ç–Ω–æ—Å—Ç—å\" (\"–≤–∞–º –Ω–∏–∫—Ç–æ –Ω–µ —Ä–∞—Å—Å–∫–∞–∂–µ—Ç, –Ω–æ —è –æ—Ç–∫—Ä–æ—é\")"
        case .comparison:
            return "–ß–µ—Å—Ç–Ω–æ—Å—Ç—å + –£–¥–∏–≤–ª–µ–Ω–∏–µ (\"—è —Å–∞–º –Ω–µ –æ–∂–∏–¥–∞–ª —Ç–∞–∫–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞\")"
        case .budget:
            return "–†–∞–¥–æ—Å—Ç—å + –ü–æ–±–µ–¥–∞ (\"—è —ç—Ç–æ —Å–¥–µ–ª–∞–ª, –∏ –≤—ã —Å–º–æ–∂–µ—Ç–µ\")"
        case .trending:
            return "–°—Ä–æ—á–Ω–æ—Å—Ç—å + FOMO (\"–≤—Å–µ —É–∂–µ –±—Ä–æ–Ω–∏—Ä—É—é—Ç, –Ω–µ –æ–ø–æ–∑–¥–∞–π\")"
        case .destination:
            return "–í–æ—Å—Ö–∏—â–µ–Ω–∏–µ + –ñ–µ–ª–∞–Ω–∏–µ (\"–≤—ã –¥–æ–ª–∂–Ω—ã —ç—Ç–æ —É–≤–∏–¥–µ—Ç—å\")"
        default:
            return "–õ—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ + –ü–æ–ª–µ–∑–Ω–æ—Å—Ç—å"
        }
    }
    
    private static func buildCategorySpecificPrompt(_ request: GenerationRequest) -> String {
        switch request.templateType {
        case .lifehack:
            return """
            **–°–ü–ï–¶–ò–§–ò–ö–ê –õ–ê–ô–§–•–ê–ö–ê:**
            - –ù–∞–∑–≤–∞–Ω–∏–µ –ª–∞–π—Ñ—Ö–∞–∫–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏–Ω—Ç—Ä–∏–≥—É—é—â–∏–º
            - –ö–∞–∂–¥—ã–π –ª–∞–π—Ñ—Ö–∞–∫ = –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ + —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ü–∏—Ñ—Ä–∞—Ö
            - –ü—Ä–∏–º–µ—Ä: "–ü–æ–∫—É–ø–∞–π—Ç–µ –±–∏–ª–µ—Ç—ã –≤ 14:00 –≤—Ç–æ—Ä–Ω–∏–∫–∞ ‚Üí —ç–∫–æ–Ω–æ–º–∏—è 30%"
            - –î–æ–±–∞–≤—å –ª–∏—á–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é: "–≠—Ç–æ—Ç —Ç—Ä—é–∫ —Å—ç–∫–æ–Ω–æ–º–∏–ª –º–Ω–µ 45 —Ç—ã—Å—è—á"
            - –ë–æ–Ω—É—Å–Ω—ã–π –ª–∞–π—Ñ—Ö–∞–∫ –≤ –∫–æ–Ω—Ü–µ (—Å–∞–º—ã–π —Å–∏–ª—å–Ω—ã–π)
            """
            
        case .comparison:
            return """
            **–°–ü–ï–¶–ò–§–ò–ö–ê –°–†–ê–í–ù–ï–ù–ò–Ø:**
            - –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ (—Ü–µ–Ω—ã, –ø–æ–≥–æ–¥–∞, –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
            - –ù–∞—á–Ω–∏ —Å "–Ø –Ω–µ –∑–Ω–∞–ª, –∫—É–¥–∞ –µ—Ö–∞—Ç—å, –∏ –≤–æ—Ç —á—Ç–æ —è —É–∑–Ω–∞–ª..."
            - –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π –≤–µ—Ä–¥–∏–∫—Ç (–Ω–µ –æ—á–µ–≤–∏–¥–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)
            - –î–ª—è –∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –∫–∞–∂–¥—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
            - –õ–∏—á–Ω—ã–π –≤—ã–≤–æ–¥: "–Ø –≤—ã–±—Ä–∞–ª X, –∏ –≤–æ—Ç –ø–æ—á–µ–º—É..."
            """
            
        case .budget:
            return """
            **–°–ü–ï–¶–ò–§–ò–ö–ê –ë–Æ–î–ñ–ï–¢–ê:**
            - –†–∞–∑–±–∏–≤–∫–∞ –±—é–¥–∂–µ—Ç–∞ –ø–æ –¥–Ω—è–º —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —Ü–∏—Ñ—Ä–∞–º–∏
            - "–í–æ—Ç —Å–∫–æ–ª—å–∫–æ —è –ø–æ—Ç—Ä–∞—Ç–∏–ª –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ (—Å —á–µ–∫–∞–º–∏)"
            - –ì–¥–µ –º–æ–∂–Ω–æ —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å, –∞ –≥–¥–µ –Ω–µ —Å—Ç–æ–∏—Ç
            - –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ç—Ä–∞—Ç—ã, –æ –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–ª—á–∞—Ç
            - –õ–∞–π—Ñ—Ö–∞–∫–∏ —ç–∫–æ–Ω–æ–º–∏–∏ –ø–æ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            """
            
        case .trending:
            return """
            **–°–ü–ï–¶–ò–§–ò–ö–ê –¢–†–ï–ù–î–û–í:**
            - –ü–æ—á–µ–º—É –≠–¢–û –ø–æ–ø—É–ª—è—Ä–Ω–æ –°–ï–ô–ß–ê–° (–ø—Ä–∏—á–∏–Ω—ã)
            - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: "–†–æ—Å—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π +300% –∑–∞ –º–µ—Å—è—Ü"
            - "–ü–æ–∫–∞ –≤—Å–µ –Ω–µ —É–∑–Ω–∞–ª–∏" - —Å–æ–∑–¥–∞—Ç—å FOMO
            - –ß—Ç–æ –±—É–¥–µ—Ç –¥–∞–ª—å—à–µ —Å —Ü–µ–Ω–∞–º–∏ (–ø—Ä–æ–≥–Ω–æ–∑)
            - –°—Ä–æ—á–Ω–æ—Å—Ç—å: "–£—Å–ø–µ–π—Ç–µ –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–æ..."
            """
            
        case .destination:
            let destination = request.destinations?.first ?? "—ç—Ç—É —Å—Ç—Ä–∞–Ω—É"
            return """
            **–°–ü–ï–¶–ò–§–ò–ö–ê –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø:**
            - –ù–∞—á–Ω–∏ —Å –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–≥–æ —Ñ–∞–∫—Ç–∞ –ø—Ä–æ \(destination)
            - –õ–∏—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è: "–ö–æ–≥–¥–∞ —è –≤–ø–µ—Ä–≤—ã–µ –ø—Ä–∏–µ—Ö–∞–ª –≤ \(destination)..."
            - –ß—Ç–æ —É–¥–∏–≤–∏–ª–æ/—à–æ–∫–∏—Ä–æ–≤–∞–ª–æ (–Ω–µ —Ç—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —à—Ç–∞–º–ø—ã)
            - –û—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã—Ö —Å—Ç–æ–∏—Ç –∏–∑–±–µ–∂–∞—Ç—å
            - –°–µ–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Å—Ç–∞, –æ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ –ø–∏—à—É—Ç –≤ –≥–∞–π–¥–∞—Ö
            """
            
        default:
            return """
            **–û–ë–©–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:**
            - –õ–∏—á–Ω—ã–π –æ–ø—ã—Ç –∏ —ç–º–æ—Ü–∏–∏
            - –ö–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞ –≤–º–µ—Å—Ç–æ –æ–±—â–∏—Ö —Ñ—Ä–∞–∑
            - –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ —Ñ–∞–∫—Ç—ã
            - –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–ª—å–∑–∞
            """
        }
    }
}

